<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.71">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Diyalog - Dlg Messenger Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Diyalog - Dlg Messenger Blog Atom Feed"><title data-react-helmet="true">Token Base Authentication | Diyalog - Dlg Messenger</title><meta data-react-helmet="true" property="og:url" content="https://diyalog-im.github.io/docs/tr/android_tokenBaseAuth"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Token Base Authentication | Diyalog - Dlg Messenger"><meta data-react-helmet="true" name="description" content="Token base auth is system that customer can register into Diyalog sdk with their application User Info, and can chat between thier application user."><meta data-react-helmet="true" property="og:description" content="Token base auth is system that customer can register into Diyalog sdk with their application User Info, and can chat between thier application user."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://diyalog-im.github.io/docs/tr/android_tokenBaseAuth"><link data-react-helmet="true" rel="alternate" href="https://diyalog-im.github.io/docs/tr/android_tokenBaseAuth" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://diyalog-im.github.io/docs/tr/android_tokenBaseAuth" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9f9d22af.css">
<link rel="preload" href="/assets/js/styles.73f4da1d.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.84e959d5.js" as="script">
<link rel="preload" href="/assets/js/main.1f86da6c.js" as="script">
<link rel="preload" href="/assets/js/1.f6e4660b.js" as="script">
<link rel="preload" href="/assets/js/2.5140cd8a.js" as="script">
<link rel="preload" href="/assets/js/88.61067ed3.js" as="script">
<link rel="preload" href="/assets/js/89.c895227e.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.a9713861.js" as="script">
<link rel="preload" href="/assets/js/17896441.05b97fed.js" as="script">
<link rel="preload" href="/assets/js/30d2363c.92ff87f5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Diyalog</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/overview">Docs</a><a class="navbar__item navbar__link" href="/aboutus">About Us</a><a class="navbar__item navbar__link" href="/contactus">Contact Us</a><a href="https://github.com/diyalog-im/diyalog-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Diyalog</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/aboutus">About Us</a></li><li class="menu__list-item"><a class="menu__link" href="/contactus">Contact Us</a></li><li class="menu__list-item"><a href="https://github.com/diyalog-im/diyalog-platform" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Token Base Authentication</h1></header><div class="markdown"><p>Token base auth is system that customer can register into Diyalog sdk with their application User Info, and can chat between thier application user. </p><p>With DiyalogSDK User can register in forground mode as well as background mode. Before authentication user need to init DiyalogSDK as below.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   DiyalogEngine.diyalogInstance().Initialize(getApplicationContext());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   DiyalogEngine.diyalogInstance().waitForReady();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="domain-customer-user"></a>Domain Customer User<a class="hash-link" href="#domain-customer-user" title="Direct link to heading">#</a></h2><p><strong>a. Foreground method</strong></p><p>For customer user registration client need to call below method with necessary information. After successfully register on server it will create session in Diyalog SDK and can start messaging. Using below method if user already created session in Diyalog SDK, then it will directly open that session and user can start messaging.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DiyalogEngine.diyalogInstance().startTokenAuth(context,dlgToken,deviceId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                               customerId,customerName, customerPhone, customerEmail); </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>context</strong> - Activity context</p><p><strong>dlgToken</strong> - Main application server will return Diyalog Token when user will login into main application
<strong>DeviceId</strong> - domain specific device id. this is for domain validation</p><p><strong>CustId</strong> - domain customer id</p><p><strong>CustName</strong> - customer name</p><p><strong>CustPhone</strong> -  customer phone number (Optional)</p><p><strong>CustEmail</strong> â€“ customer email address (Optional)</p><p><strong>b. Background method</strong></p><p>When customer user will call background method then it will be register on server and after successfully register, it will create session into sdk.
And when user will click on Diyalog chat icon from main application to open sdk, it will directly open that session. user does not wait for register.
And In background method if there is any failure then it will pass error message into failure callback.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DiyalogEngine.diyalogInstance().startTokenAuthInBackground(context,dlgToken,deviceId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                               customerId,customerName, customerPhone, customerEmail, new TokenAuthResponse() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    public void success() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;,&quot;==&gt;&gt; Success &quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    public void failure(TokenAuthError tokenAuthError) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;, &quot;==&gt;&gt; Error Message: &quot; + tokenAuthError.getErrorMsg());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;, &quot;==&gt;&gt; Error Code: &quot;+  tokenAuthError.getErrorCode());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }) ;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="domain-staff-user"></a>Domain Staff User<a class="hash-link" href="#domain-staff-user" title="Direct link to heading">#</a></h2><p><strong>a. Foreground method</strong></p><p>For staff user registration client need to call below method with necessary information. After successfully register on server it will create session in Diyalog SDK and can start messaging. Using below method if user already created session in Diyalog SDK, then it will directly open that session and user can start messaging.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   DiyalogEngine.diyalogInstance().startDomainUserTokenAuth( context,  dlgToken,   sessionId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userName,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userPhone,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userEmail);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>context</strong> - Activity context</p><p><strong>dlgToken</strong> - Main application server will return Diyalog Token when user will login into main application</p><p><strong>sessionId</strong> â€“ Staff user&#x27;s sessionId</p><p><strong>userId</strong> - Staff user&#x27;s UserID</p><p><strong>UserName</strong> - Staff user&#x27;s UserName</p><p><strong>userPhone</strong>  - Staff user&#x27;s PhoneNumber(Optional)</p><p><strong>userEmail</strong> - Staff user&#x27;s EmailID (Optional)</p><p><strong>b. Background method</strong>
When staff user will call background method then it will be register on server and after successfully register, it will create session into sdk.
And when user will click on Diyalog chat icon from main application to open sdk, it will directly open that session. user does not wait for register.
And In background method if there is any failure then it will pass error message into failure callback.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DiyalogEngine.diyalogInstance().startDomainUserTokenAuthInBackground(context,  dlgToken,   sessionId, userId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userName, userPhone, userEmail, new TokenAuthResponse() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    public void success() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;,&quot;==&gt;&gt; Success &quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                       </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    public void failure(TokenAuthError tokenAuthError) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;, &quot;==&gt;&gt; Error Message: &quot; + tokenAuthError.getErrorMsg());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;, &quot;==&gt;&gt; Error Code: &quot;+  tokenAuthError.getErrorCode());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }) ;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="get-active-sessions"></a>Get Active sessions<a class="hash-link" href="#get-active-sessions" title="Direct link to heading">#</a></h2><p>User can get all sessions list those already registered in diyalog SDK. This method will be use for both Domain customer user and staff user.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ArrayList&lt;AccountVo&gt; sessionList = DiyalogEngine.diyalogInstance().getActiveSessions();</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This method will return list of saved session from sdk.
It will contain userInfo as below:</p><ul><li>ApplicationUserID</li><li>AuthID</li><li>UserName</li><li>User Image.</li><li>User is active or not</li><li>Unread message count</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="messaging-from-specific-user"></a>Messaging from specific User<a class="hash-link" href="#messaging-from-specific-user" title="Direct link to heading">#</a></h2><p>User can start messaging from specific user. If session already saved into Diyalog SDK then user can start messaging with thier UserID. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">DiyalogEngine.diyalogInstance().startMessagingWithUserId(context,customerId);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>context</strong> - Activity context</p><p><strong>customerId</strong> -  domain customer id</p><p>This method will be use for both Domain customer user and staff user.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="delete-session-of-user"></a>Delete session of user<a class="hash-link" href="#delete-session-of-user" title="Direct link to heading">#</a></h2><p>Client can delete session of diyalog sdk for any user.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">boolean isDelted = DiyalogEngine.diyalogInstance().deleteSessionOfUser(customerId); </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="get-total-unread-count-into-main-application"></a>Get total unread count into main application.<a class="hash-link" href="#get-total-unread-count-into-main-application" title="Direct link to heading">#</a></h2><p>Client can get total no of unread message count into main application, so they can set unread badge count into main application. Client need to subscribe unread count event as below:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DiyalogEngine.diyalogInstance().subscribeToTotalUnreadCountEvent(new ValueChangedListener&lt;Integer&gt;() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    public void onChanged(Integer val, Value&lt;Integer&gt; valueModel) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        unreadCount.setText(String.valueOf(val));  // unreadCount is textview for display unread message count.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#domain-customer-user" class="table-of-contents__link">Domain Customer User</a></li><li><a href="#domain-staff-user" class="table-of-contents__link">Domain Staff User</a></li><li><a href="#get-active-sessions" class="table-of-contents__link">Get Active sessions</a></li><li><a href="#messaging-from-specific-user" class="table-of-contents__link">Messaging from specific User</a></li><li><a href="#delete-session-of-user" class="table-of-contents__link">Delete session of user</a></li><li><a href="#get-total-unread-count-into-main-application" class="table-of-contents__link">Get total unread count into main application.</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/overview">Docs</a></li><li class="footer__item"><a href="https://github.com/diyalog-im/diyalog-platform" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/aboutus">About Us</a></li><li class="footer__item"><a class="footer__link-item" href="/contactus">Contact Us</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/privacy">Privacy and Terms</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Downloads</h4><ul class="footer__items"><li class="footer__item"><a href="https://play.google.com/store/apps/details?id=im.diyalog.diyalogapp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Android</a></li><li class="footer__item"><a href="https://apps.apple.com/us/app/dlg-messenger/id1449572267?ls=1" target="_blank" rel="noopener noreferrer" class="footer__link-item">iPhone</a></li><li class="footer__item"><a href="https://web.dlgmessenger.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Web App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 Diyalog - All Rights Reserved</div></div></div></footer></div>
<script src="/assets/js/styles.73f4da1d.js"></script>
<script src="/assets/js/runtime~main.84e959d5.js"></script>
<script src="/assets/js/main.1f86da6c.js"></script>
<script src="/assets/js/1.f6e4660b.js"></script>
<script src="/assets/js/2.5140cd8a.js"></script>
<script src="/assets/js/88.61067ed3.js"></script>
<script src="/assets/js/89.c895227e.js"></script>
<script src="/assets/js/935f2afb.a9713861.js"></script>
<script src="/assets/js/17896441.05b97fed.js"></script>
<script src="/assets/js/30d2363c.92ff87f5.js"></script>
</body>
</html>