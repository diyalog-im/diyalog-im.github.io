<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.71">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Diyalog - Dlg Messenger Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Diyalog - Dlg Messenger Blog Atom Feed"><title data-react-helmet="true">Token-Based Authentication | Diyalog - Dlg Messenger</title><meta data-react-helmet="true" property="og:url" content="https://diyalog-im.github.io/docs/iOS_TokenBaseAuthentication"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Token-Based Authentication | Diyalog - Dlg Messenger"><meta data-react-helmet="true" name="description" content="There is a token-based authentication mechanism that allows a user who is logged in to your mobile application to securely activate the device they are logged in to in the Diyalog system. A user who has activated dialogue can now chat, make voice or video calls, and receive messages sent from your backoffice applications via that device."><meta data-react-helmet="true" property="og:description" content="There is a token-based authentication mechanism that allows a user who is logged in to your mobile application to securely activate the device they are logged in to in the Diyalog system. A user who has activated dialogue can now chat, make voice or video calls, and receive messages sent from your backoffice applications via that device."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://diyalog-im.github.io/docs/iOS_TokenBaseAuthentication"><link data-react-helmet="true" rel="alternate" href="https://diyalog-im.github.io/docs/iOS_TokenBaseAuthentication" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://diyalog-im.github.io/docs/iOS_TokenBaseAuthentication" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9f9d22af.css">
<link rel="preload" href="/assets/js/styles.73f4da1d.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.a6a20db5.js" as="script">
<link rel="preload" href="/assets/js/main.63459a4a.js" as="script">
<link rel="preload" href="/assets/js/1.d84ef581.js" as="script">
<link rel="preload" href="/assets/js/2.74c1eb06.js" as="script">
<link rel="preload" href="/assets/js/93.f57d768b.js" as="script">
<link rel="preload" href="/assets/js/94.76b7fff7.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.acf8a4b4.js" as="script">
<link rel="preload" href="/assets/js/17896441.fcf0b8d5.js" as="script">
<link rel="preload" href="/assets/js/95dd6149.90f7eb78.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Diyalog</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/overview">Docs</a><a class="navbar__item navbar__link" href="/aboutus">About Us</a><a class="navbar__item navbar__link" href="/contactus">Contact Us</a><a href="https://github.com/diyalog-im/diyalog-platform" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/./img/diyalog_logo_32h.png" alt="Diyalog" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Diyalog</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/overview">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/aboutus">About Us</a></li><li class="menu__list-item"><a class="menu__link" href="/contactus">Contact Us</a></li><li class="menu__list-item"><a href="https://github.com/diyalog-im/diyalog-platform" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getstarted">Getting Started</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Android</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/android_getting_started">How to use Diyalog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/android_configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/android_style">Styling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/android_notification_configuration">Notifications</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Use Cases</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/android_video_help">Video Help</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/android_online_help">Online Help</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/android_tokenBaseAuth">Token Base Authentication</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">iOS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iOS_getting_started">How to use Diyalog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ios_configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iOS_style">Styling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ios_notification_configuration">Notifications</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/iOS_RichView">RichView Notification Support</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Use Cases</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ios_video_help">Video Help</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ios_online_help">Online Help</a></li></ul></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/iOS_TokenBaseAuthentication">Token-Based Authentication</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Cordova plugin</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cordova_HowToUseCordova">How to add Cordova plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cordova_CreatePlugin">How to create Cordova plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/cordova_CreateIonicProject">How to create ionic project</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Web SDK</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalogWeb_WebSdk">How to use WEB SDK</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalogWeb_OpenDiyalogSDK">Use Web SDK Javascript from My Web App</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalogWeb_OpenInDiyalogSDKAngularJSApp">Use Web SDK from AngularJS Web App</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalogWeb_OpenInIFrame">How to Use Diyalog Web App in Iframe</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Required Api Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-required-api-reference-overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-required-api-authentication-services">Authentication Services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-required-api-queuing-services">Call Center Queueing Services</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-required-api-document-management-services">Document Management Services</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Diyalog Api Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-api-authentication">Authentication</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Messaging API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-overview">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-sendmessage-api">SendMessage API</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Templates</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-textmessage">Text Message</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-quickreplies">Quick Replies Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-generictemplate">Generic Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-buttontemplate">Button Template</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-triggerappmessage">Trigger App Message</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-documentmessage">Document Message</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-messaging-api-sendotp-api">SendOTP API</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/webhook">Webhooks</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Application API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-application-api-overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-application-api-gettransactionhashforonlinehelp">gettransactionhashforonlinehelp</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Reporting API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-reporting-api-overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-reporting-api-getonlinehelplist">getonlinehelplist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-reporting-api-getcalllist">getcalllist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-reporting-api-getstaffmessaginglist">getstaffmessaginglist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-reporting-api-getcustomermessaginglist">getcustomermessaginglist</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-reporting-api-getmessagingdetail">getmessagingdetail</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">SimplePush API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-simplepush-api-overview">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">APIs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-simplepush-api-sendpush">sendpush</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-simplepush-api-notificationstatus">notificationstatus</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/diyalog-simplepush-api-notificationstatusofuser">notificationstatusofuser</a></li></ul></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ops_rancher_restart">Rancher 1.6 Operations</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Privacy and Terms</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/privacy">Diyalog (dlg) Messenger Legal Info</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Token-Based Authentication</h1></header><div class="markdown"><p>There is a token-based authentication mechanism that allows a user who is logged in to your mobile application to securely activate the device they are logged in to in the Diyalog system. A user who has activated dialogue can now chat, make voice or video calls, and receive messages sent from your backoffice applications via that device.</p><p>In order to perform token-based authentication for Dialog activation from your mobile application, you must first configure the Diyalog SDK and create the Dialog Instance once your application is opened. You can find details for these processes in the <strong>How â€‹â€‹to use Dialog</strong>, <strong>Configuration</strong> and <strong>Styling</strong> documents.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="domain-customer-user"></a>DOMAIN CUSTOMER USER<a class="hash-link" href="#domain-customer-user" title="Direct link to heading">#</a></h3><p>The general flow of the token-based authentication mechanism of the Diyalog system for customers is tried to be shown in the following diagram.</p><p><img src="/assets/images/mobileAppAuth-1c7cf240e88107cc60ca08f9f87edbb1.png"></p><p>As explained in the flow above, in order to initiate Diyalog activation on that device for the user who is logged in to your mobile application, you are expected to generate a random token specific to Diyalog in your backend server. Your mobile application should receive this token and give it to the methods detailed below to DiyalogSDK. DiyalogSDK receives this token and sends it to its own server, and the Diyalog server will validate this token by calling your <a href="/docs/diyalog-required-api-authentication-services#customer-token-verification-service-api">checkauthtoken</a> API that you will provide, and will activate the user on that device after verification.</p><p>You can activate Diyalog in your mobile application with two different methods. The first of these is to use the method we call the background method, and the other is to use the method we call the frontend method. The background method activates Diyalog in the background, gives you the result, and then closes the Diyalog server connections. The other method activates the user via Diyalog and keeps the connections to server open. This second method should be used if Diyalog screens will be opened directly after the user activation. If Dialog screens will not be opened directly to the user and the user will use Diyalog screens later when desired, the background method should be used.</p><p>Regardless of which method is used, after your user logs into your application on your system, you are expected to generate a token to authenticate your user on your system and give this token to the method you call so that Diyalog can authenticate your user via your servers. Diyalog will receive this token and send it to its own server, and Diyalog server will send this token to the API detailed in the <a href="/docs/diyalog-required-api-authentication-services#customer-token-verification-service-api">checkauthtoken</a> document below and expected to be implemented on your servers to perform the verification. After verification, the user is created in the Diyalog system and the user is bound with the device.</p><p><strong>a. Background method</strong>  </p><p>With this method, your user will be registered securely to the Diyalog system. After registration, a session will be created in the SDK then the SDK will close its connections with the server.</p><p><strong>Method Definition :</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@objc open func startTokenAuthInBackground(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dlgToken: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deviceID: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerID: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerName: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerPhone: String = &quot;0&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerEmail: String = &quot;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    result: @escaping (Bool, TokenAuthError?) -&gt; Void)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Usage :</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">DiyalogEngine.diyalogInstance().startTokenAuthInBackground(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dlgToken: &quot;&lt;Token generated on your server&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deviceID: &quot;&lt;device id corralated with token&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerID: &quot;&lt;customerId&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerName: &quot;&lt;Full name of the customer&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerPhone: &quot;&lt;Optional - Customer phone number&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerEmail: &quot;&lt;Optional - Customer email address&gt;&quot;) { (success, errorMessage) in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if(success)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(&quot;Success&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }else{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            //print(&quot;there is an error&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(&quot;there is an error \(String(describing: errorMessage?.errorCode))&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Parameters :</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Description</th><th>Mandatory</th></tr></thead><tbody><tr><td>dlgToken</td><td>String</td><td>Token generated for logged in user for Diyalog auth</td><td>Yes</td></tr><tr><td>deviceID</td><td>String</td><td>Unique device id corralated with token</td><td>Yes</td></tr><tr><td>customerID</td><td>String</td><td>Customer Id of the user</td><td>Yes</td></tr><tr><td>customerName</td><td>String</td><td>Name of the user</td><td>Yes</td></tr><tr><td>customerPhone</td><td>String</td><td>Phone number  of the user</td><td>No</td></tr><tr><td>customerEmail</td><td>String</td><td>Email address of the user</td><td>No</td></tr></tbody></table><p>The method runs asynchronously and its result is returned in the completion/callback function result.</p><p><strong>result :</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Description</th><th>Values</th></tr></thead><tbody><tr><td>success</td><td>Boolean</td><td>It returns activation success or nor.</td><td>true : Success false: failed</td></tr><tr><td>error</td><td>TokenAuthError</td><td>Failure detail if activation is failed.</td><td>Instance of <a href="/docs/iOS_TokenBaseAuthentication#tokenautherror">TokenAuthError</a></td></tr></tbody></table><p><strong>b. Foreground method</strong></p><p>This method is different from the background method, if Diyalog messaging screens will be opened and used immediately after Diyalog activation, you can use this method. This method was added to prevent delays during the establishment of the Diyalog server connection with the client.</p><p>If Diyalog screens will not be opened after activation, you should not use this method. Because a connection will remain open in the Diyalog system unnecessarily.</p><p><strong>Method Definition :</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@objc open func startTokenAuthForOpenDlg(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dlgToken: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deviceID: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerID: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerName: String, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerPhone: String = &quot;0&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerEmail: String = &quot;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    result: @escaping (Bool, TokenAuthError?) -&gt; Void)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Usage :</strong></p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">DiyalogEngine.diyalogInstance().startTokenAuthForOpenDlg(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    dlgToken: &quot;&lt;Token generated on your server&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    deviceID: &quot;&lt;device id corralated with token&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerID: &quot;&lt;customerId&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerName: &quot;&lt;Full name of the customer&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerPhone: &quot;&lt;Optional - Customer phone number&gt;&quot;, </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    customerEmail: &quot;&lt;Optional - Customer email address&gt;&quot;) { (success, errorMessage) in</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        if(success)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(&quot;Success&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }else{</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            //print(&quot;there is an error&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            print(&quot;there is an error \(String(describing: errorMessage?.errorCode))&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>Parameters :</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Description</th><th>Mandatory</th></tr></thead><tbody><tr><td>dlgToken</td><td>String</td><td>Token generated for logged in user for Diyalog auth</td><td>Yes</td></tr><tr><td>deviceID</td><td>String</td><td>Unique device id corralated with token</td><td>Yes</td></tr><tr><td>customerID</td><td>String</td><td>Customer Id of the user</td><td>Yes</td></tr><tr><td>customerName</td><td>String</td><td>Name of the user</td><td>Yes</td></tr><tr><td>customerPhone</td><td>String</td><td>Phone number  of the user</td><td>No</td></tr><tr><td>customerEmail</td><td>String</td><td>Email address of the user</td><td>No</td></tr></tbody></table><p>The method runs asynchronously and its result is returned in the completion/callback function result.</p><p><strong>result :</strong></p><table><thead><tr><th>Parameter Name</th><th>Type</th><th>Description</th><th>Values</th></tr></thead><tbody><tr><td>success</td><td>Boolean</td><td>It returns activation success or nor.</td><td>true : Success false: failed</td></tr><tr><td>error</td><td>TokenAuthError</td><td>Failure detail if activation is failed.</td><td>Instance of <a href="/docs/iOS_TokenBaseAuthentication#tokenautherror">TokenAuthError</a></td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="domain-staff-user"></a>DOMAIN STAFF USER<a class="hash-link" href="#domain-staff-user" title="Direct link to heading">#</a></h3><p><strong>a. Foreground method</strong>
For staff user registration client need to call below method with necessary information. After successfully register on server it will create session in Diyalog SDK and can start messaging. Using below method if user already created session in Diyalog SDK, then it will directly open that session and user can start messaging.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">   DiyalogEngine.diyalogInstance().startDomainUserTokenAuth( context,  dlgToken,   sessionId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userName,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userPhone,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userEmail);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>context</strong> - Activity context
<strong>dlgToken</strong> - Main application server will return Diyalog Token when user will login into main application
<strong>sessionId</strong> â€“ Staff user&#x27;s sessionId
<strong>userId</strong> - Staff user&#x27;s UserID
<strong>UserName</strong> - Staff user&#x27;s UserName
<strong>userPhone</strong>  - Staff user&#x27;s PhoneNumber(Optional)
<strong>userEmail</strong> - Staff user&#x27;s EmailID (Optional)</p><p><strong>b. Background method</strong>
When staff user will call background method then it will be register on server and after successfully register, it will create session into sdk.
And when user will click on Diyalog chat icon from main application to open sdk, it will directly open that session. user does not wait for register.
And In background method if there is any failure then it will pass error message into failure callback.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> DiyalogEngine.diyalogInstance().startDomainUserTokenAuthInBackground(context,  dlgToken,   sessionId, userId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                                         userName, userPhone, userEmail, new TokenAuthResponse() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    public boolean success() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;,&quot;==&gt;&gt; Success &quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        return false;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    public String failure(String errorMsg) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        Log.e(&quot;Auth In Bakground&quot;,&quot;==&gt;&gt; Error: &quot;+errorMsg);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                        return null;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                }) ;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="get-active-sessions"></a>Get Active sessions<a class="hash-link" href="#get-active-sessions" title="Direct link to heading">#</a></h3><p>User can get all sessions list those already registered in diyalog SDK. This method will be use for both Domain customer user and staff user.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">ArrayList&lt;AccountVo&gt; sessionList = DiyalogEngine.diyalogInstance().getActiveSessions();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This method will return list of saved session from sdk.
It will contain userInfo as below:</p><ul><li>ApplicationUserID</li><li>AuthID</li><li>UserName</li><li>User Image.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="messaging-from-specific-user"></a>Messaging from specific User<a class="hash-link" href="#messaging-from-specific-user" title="Direct link to heading">#</a></h3><p>User can start messaging from specific user. If session already saved into Diyalog SDK then user can start messaging with thier UserID. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">DiyalogEngine.diyalogInstance().startMessagingWithUserId(context,customerId);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p><strong>context</strong> - Activity context
<strong>customerId</strong> -  domain customer id</p><p>This method will be use for both Domain customer user and staff user.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="tokenautherror"></a>TokenAuthError<a class="hash-link" href="#tokenautherror" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sh"><div tabindex="0" class="prism-code language-sh codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@objc open class TokenAuthError: NSObject {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @objc open var errorCode: String    = &quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    @objc open var errorMsg: String     = &quot;&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    init(_ errorCode: String, _ errorMsg: String) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self.errorCode = errorCode</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        self.errorMsg = errorMsg</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>In cases where activation fails, the following errorCode and errorMsg values â€‹â€‹are returned.</p><table><thead><tr><th>errorCode</th><th>errorMsg (English)</th><th>errorMsg (Turkish)</th><th>Meaning</th></tr></thead><tbody><tr><td>DLGEXCPINP_DVCID</td><td>You must need to pass deviceId.</td><td>deviceId parametresi dolu olmalÄ±dÄ±r.</td><td>You did not provide the deviceId parameter to the method correctly.</td></tr><tr><td>DLGEXCPINP_CSTID</td><td>You must need to pass customer Id.</td><td>customerId parametresi dolu olmalÄ±dÄ±r.</td><td>You did not provide the customerId parameter to the method correctly.</td></tr><tr><td>DLGEXCPINP_CSTNM</td><td>You must need to pass customer name.</td><td>customerName parametresi dolu olmalÄ±dÄ±r.</td><td>You did not provide the customerName parameter to the method correctly.</td></tr><tr><td>DLGEXCPINP_TKN</td><td>You must need to pass diyalog token.</td><td>diyalogToken parametresi dolu olmalÄ±dÄ±r.</td><td>You did not provide the diyalogToken parameter to the method correctly.</td></tr><tr><td>DLGEXCPSRV_INVLDNM</td><td>Customer id is invalid.</td><td>MÃ¼ÅŸteri no hatalÄ±</td><td>Customer Id is not found in the system.</td></tr><tr><td>DLGEXCPSRV_FRBDNCST</td><td>Forbidden customer.</td><td>YasaklÄ± mÃ¼ÅŸteri.</td><td>Provided customer is forbidden to use Diyalog.</td></tr><tr><td>DLGEXCPSRV_TXHSHEXP</td><td>transactionHash has expired.</td><td>transactionHash bilgisinin sÃ¼resi geÃ§miÅŸ.</td><td>This error occurs if the internal transaction hash information created in the Diyalog system has been used before. This error may occur when the same activation request is called more than once. It is not expected to occur.</td></tr><tr><td>DLGEXCPSRV_TKNNOTVLD</td><td>dlgToken is not validated by auth server.</td><td>dlgToken otorizasyon sunucusu tarafÄ±ndan doÄŸrulanmadÄ±.</td><td>This error occurs when your token is not verified by the token verification service.</td></tr><tr><td>DLGEXCPSRV_AUTHSRVERR</td><td>Internal failure in Auth server.</td><td>Otorizasyon sunucusu internal hata.</td><td>This error indicates that an internal server error response returned from your token verification service.</td></tr><tr><td>DLGEXCPSRV_BADREQ</td><td>The request rejected by auth server.</td><td>Otorizasyon sunucusu isteÄŸi kabul etmedi.</td><td>This error indicates that an bad request response was returned from your token verification service.</td></tr><tr><td>DLGEXCPSRV_TKNEXP</td><td>dlgToken is expired.</td><td>dlgToken sÃ¼resi dolmuÅŸ</td><td>This error is the error code returned by your token verification service when the token has expired.</td></tr><tr><td>DLGEXCPSRV_TKNINVLD</td><td>dlgToken is invalid.</td><td>GeÃ§ersiz dlgToken.</td><td>Token is not validated by your token verification service.</td></tr><tr><td>DLGEXCPSRV_DVCIDINVLD</td><td>Invalid device id.</td><td>GeÃ§ersiz cihaz id.</td><td>Device id is not found by your token verification service.</td></tr><tr><td>DLGEXCPSRV_SIDINVLD</td><td>Invalid session id.</td><td>GeÃ§ersiz session id.</td><td>Session Id is not found by your token verification service.</td></tr><tr><td>DLGEXCPSRV_AUTHSRVINACC</td><td>Token authorisation server is not accessible.</td><td>Token otorizasyon sunucusuna eriÅŸim yok.</td><td>Your token verification service is not responding.</td></tr><tr><td>DLGEXCPSRV_INTERR</td><td>message in RpcException</td><td>message in RpcException</td><td>This is rpc exception of the the Diyalog Server.</td></tr><tr><td>DLGEXCPINP_SESID</td><td>You must need to pass session Id.</td><td>Oturum kimliÄŸini geÃ§meniz gerekiyor.</td><td>You did not provide the sessionId parameter to the method correctly.</td></tr><tr><td>DLGEXCPINP_USRID</td><td>You must need to pass user Id.</td><td>KullanÄ±cÄ± kimliÄŸini geÃ§meniz gerekiyor.</td><td>You did not provide the userId parameter to the method correctly.</td></tr><tr><td>DLGEXCPINP_USRNM</td><td>You must need to pass user name.</td><td>KullanÄ±cÄ± adÄ±nÄ± geÃ§meniz gerekiyor.</td><td>You did not provide the userName parameter to the method correctly.</td></tr><tr><td>DLGEXCPSRV_CONNERR</td><td>Unable to connect.</td><td>Unable to connect. Please check that you are connected to the Internet.</td><td>This error occurs when Diyalog SDK is not connected to the Diyalog server due to network or endpoint configuration error.</td></tr></tbody></table></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ios_online_help"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Starting Online Help</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/cordova_HowToUseCordova"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Details steps to add DiyalogSDK Cordova plugin to ionic application Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#domain-customer-user" class="table-of-contents__link">DOMAIN CUSTOMER USER</a></li><li><a href="#domain-staff-user" class="table-of-contents__link">DOMAIN STAFF USER</a></li><li><a href="#get-active-sessions" class="table-of-contents__link">Get Active sessions</a></li><li><a href="#messaging-from-specific-user" class="table-of-contents__link">Messaging from specific User</a></li><li><a href="#tokenautherror" class="table-of-contents__link">TokenAuthError</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/overview">Docs</a></li><li class="footer__item"><a href="https://github.com/diyalog-im/diyalog-platform" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Company</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/aboutus">About Us</a></li><li class="footer__item"><a class="footer__link-item" href="/contactus">Contact Us</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/privacy">Privacy and Terms</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Downloads</h4><ul class="footer__items"><li class="footer__item"><a href="https://play.google.com/store/apps/details?id=im.diyalog.diyalogapp" target="_blank" rel="noopener noreferrer" class="footer__link-item">Android</a></li><li class="footer__item"><a href="https://apps.apple.com/us/app/dlg-messenger/id1449572267?ls=1" target="_blank" rel="noopener noreferrer" class="footer__link-item">iPhone</a></li><li class="footer__item"><a href="https://web.dlgmessenger.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Web App</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2024 Diyalog - All Rights Reserved</div></div></div></footer></div>
<script src="/assets/js/styles.73f4da1d.js"></script>
<script src="/assets/js/runtime~main.a6a20db5.js"></script>
<script src="/assets/js/main.63459a4a.js"></script>
<script src="/assets/js/1.d84ef581.js"></script>
<script src="/assets/js/2.74c1eb06.js"></script>
<script src="/assets/js/93.f57d768b.js"></script>
<script src="/assets/js/94.76b7fff7.js"></script>
<script src="/assets/js/935f2afb.acf8a4b4.js"></script>
<script src="/assets/js/17896441.fcf0b8d5.js"></script>
<script src="/assets/js/95dd6149.90f7eb78.js"></script>
</body>
</html>