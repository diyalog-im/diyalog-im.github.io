(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{121:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return l})),a.d(t,"Highlight",(function(){return c})),a.d(t,"HighlightWithBlack",(function(){return s})),a.d(t,"HighlightWithRed",(function(){return d})),a.d(t,"ColoredText",(function(){return b})),a.d(t,"CenteredText",(function(){return p})),a.d(t,"GreenColoredText",(function(){return u})),a.d(t,"BlueColoredText",(function(){return m})),a.d(t,"SmallText",(function(){return h})),a.d(t,"toc",(function(){return g})),a.d(t,"default",(function(){return f}));var n=a(3),o=a(7),r=(a(0),a(158)),i=(a(159),{id:"ios_video_help",title:"Starting Video Help",sidebar_label:"Video Help"}),l={unversionedId:"ios_video_help",id:"ios_video_help",isDocsHomePage:!1,title:"Starting Video Help",description:"<span",source:"@site/../docs/ios_video_help.md",slug:"/ios_video_help",permalink:"/docs/ios_video_help",version:"current",sidebar_label:"Video Help",sidebar:"docs",previous:{title:"RichView Notification Support",permalink:"/docs/iOS_RichView"},next:{title:"Starting Online Help",permalink:"/docs/ios_online_help"}},c=function(e){var t=e.children,a=e.color;return Object(r.b)("span",{style:{backgroundColor:a,borderRadius:"2px",color:"#fff",padding:"0.2rem"}},t)},s=function(e){var t=e.children,a=e.color;return Object(r.b)("span",{style:{backgroundColor:a,borderRadius:"2px",padding:"0.2rem"}},t)},d=function(e){var t=e.children,a=e.color;return Object(r.b)("span",{style:{color:"#d60b0b",backgroundColor:a,borderRadius:"2px",padding:"0.2rem"}},t)},b=function(e){var t=e.children,a=e.color;return Object(r.b)("span",{style:{color:a}},t)},p=function(e){var t=e.children;return Object(r.b)("span",{style:{align:"center"}},t)},u=function(e){var t=e.children;return Object(r.b)("span",{style:{color:"#42b72a"}},t)},m=function(e){var t=e.children;return Object(r.b)("span",{style:{color:"#1877F2"}},t)},h=function(e){var t=e.children;return Object(r.b)("span",{style:{fontSize:"smaller"}},t)},g=[{value:"Main Flow",id:"main-flow",children:[]},{value:"Picture In Picture Mode",id:"picture-in-picture-mode",children:[]},{value:"Start Another Operation When Call In Progress",id:"start-another-operation-when-call-in-progress",children:[]},{value:"Receiving Data From Remote Party In a Call",id:"receiving-data-from-remote-party-in-a-call",children:[]},{value:"Sending Data To Remote Party In a Call",id:"sending-data-to-remote-party-in-a-call",children:[]},{value:"Sample IOS project",id:"sample-ios-project",children:[]}],O={Highlight:c,HighlightWithBlack:s,HighlightWithRed:d,ColoredText:b,CenteredText:p,GreenColoredText:u,BlueColoredText:m,SmallText:h,toc:g};function f(e){var t=e.components,i=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},O,i,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Diyalog Platform offers live assistance to your customers through your mobile application with video calls. "),Object(r.b)("p",null,"You can download full simple video call ios project from ",Object(r.b)("a",{parentName:"p",href:"https://web.diyalog.im/app/pkgs/demoapps/SimpleVideoCall_IOS.zip"},"SimpleVideoCall_IOS")," link.  "),Object(r.b)("h3",{id:"main-flow"},"Main Flow"),Object(r.b)("p",null,"First of all, you need to know the flow about video call help in Diyalog platform for anonymous users. Anonymous user means you can connect logged in or not logged in user with your representatives."),Object(r.b)("p",null,"The flow is like below :"),Object(r.b)("p",null,Object(r.b)("img",{src:a(219).default})),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Your app calls the DiyalogSDK ",Object(r.b)("strong",{parentName:"li"},"startVideoCallWithAttachedDataInBackground")," method. "),Object(r.b)("li",{parentName:"ol"},Object(r.b)("strong",{parentName:"li"},"startVideoCallWithAttachedDataInBackground")," connects Diyalog Server and server will add your video call request to  your representative queue then return to sdk about the result."),Object(r.b)("li",{parentName:"ol"},Object(r.b)("strong",{parentName:"li"},"startVideoCallWithAttachedDataInBackground")," works asyncronously and result of the method call will return to your app in a callback method."),Object(r.b)("li",{parentName:"ol"},"If inserting queue successfull then DiyalogSDK waits in background without showing any screen in your mobile app until a representative connecting . Therefore, you should show your wait screen thaht showing a representative will connect soon."),Object(r.b)("li",{parentName:"ol"},"If any represenatative connecting, DiyalogSDK will automatically starts video call and come into foreground. "),Object(r.b)("li",{parentName:"ol"},"After you retrun succecsfull result from ",Object(r.b)("strong",{parentName:"li"},"startVideoCallWithAttachedDataInBackground")," function, You can follow all stages of the video call by subscribing CallState in DiyalogSDK. So, you should subscribe to CallState by calling ",Object(r.b)("strong",{parentName:"li"},"subscribeToCallStateWithTxCodeEvent")," in DiyalogSDK.")),Object(r.b)("p",null,"According to your business needs, a video call can be started at the relevant stage of your application as follows. When the following method is called, the DiyalogSDK in the background will transmit the call request to the call center over the server, and it will be waiting in the background until a representative from the call center initiates the call. During this process, the standby screen should be displayed in your mobile application. Customers who are tired of waiting should be allowed to cancel the transaction by adding a cancellation option to the waiting screen."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'@objc open func startVideoCallWithAttachedDataInBackground(\n                                            idNumber : Int64,\n                                            customerId : String, \n                                            customerName : String = "", \n                                            phoneNumber : Int64 = 0, \n                                            txCode: String = "",  \n                                            attachedData: [ACAttachedData], \n                                            result: @escaping (Bool, ACVideoCallError?) -> Void)\n')),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",{parentName:"tr",align:"left"},"Parameters"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:"left"},Object(r.b)(h,{mdxType:"SmallText"},Object(r.b)(m,{mdxType:"BlueColoredText"},"idNumber")," ",Object(r.b)(u,{mdxType:"GreenColoredText"},"(Long)")," ",Object(r.b)("br",null),"National ID number of the customer."))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:"left"},Object(r.b)(h,{mdxType:"SmallText"},Object(r.b)(m,{mdxType:"BlueColoredText"},"customerId")," ",Object(r.b)(u,{mdxType:"GreenColoredText"},"(String)")," Customer id number. This can be real of candidate customer id."))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:"left"},Object(r.b)(h,{mdxType:"SmallText"},Object(r.b)(m,{mdxType:"BlueColoredText"},"customerName")," ",Object(r.b)(u,{mdxType:"GreenColoredText"},"(String)")," ",Object(r.b)("br",null),"Opsiyoneldir. ",Object(r.b)("br",null),"Name of the customer. This paramater is optional. It can be set empty."))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:"left"},Object(r.b)(h,{mdxType:"SmallText"},Object(r.b)(m,{mdxType:"BlueColoredText"},"customerPhone")," ",Object(r.b)(u,{mdxType:"GreenColoredText"},"(Long)")," ",Object(r.b)("br",null),"Opsiyoneldir. ",Object(r.b)("br",null),"Phone number of the customer. This paramater is optional. It can be set 0."))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:"left"},Object(r.b)(h,{mdxType:"SmallText"},Object(r.b)(m,{mdxType:"BlueColoredText"},"txCode")," ",Object(r.b)(u,{mdxType:"GreenColoredText"},"(String)")," This field is a parameter used only in the mobile client. The main application can distinguish the callState events of the its video calls in from other call.  CallState events related to the conversation status are returned to the main application with this txcode parameter. It is in no way migrated to the server or agent application."))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:"left"},Object(r.b)(h,{mdxType:"SmallText"},Object(r.b)(m,{mdxType:"BlueColoredText"},"attachedData")," ",Object(r.b)(u,{mdxType:"GreenColoredText"},"(ArrayList of AttachedData)")," ",Object(r.b)("br",null),"Opsiyoneldir. ",Object(r.b)("br",null),"With this parameter, you can send the data you want to the agent application. The Diyalog server transmits the data in the key-value array in this parameter to the Agent application. The data transmitted in this area is not stored on the Diyalog servers, only transmitted."))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",{parentName:"tr",align:"left"},Object(r.b)(h,{mdxType:"SmallText"},Object(r.b)(m,{mdxType:"BlueColoredText"},"result")," ",Object(r.b)(u,{mdxType:"GreenColoredText"},"(Bool, ACVideoCallError?)")," ",Object(r.b)("strong",{parentName:"td"},"startVideoCallWithAttachedDataInBackground")," method is an asynchronous method and sends the result (information that the call request has been started) to your application with this callback method. ",Object(r.b)("br",null),Object(r.b)("br",null),"If Bool value return true, the method successfull and means waiting in background to connect a repsresentative",Object(r.b)("br",null),"If Bool value return false, the method failed. And You can check failure reason from ACVideoCallError"))))),Object(r.b)("p",null,"You can use ",Object(r.b)("strong",{parentName:"p"},"startVideoCallWithAttachedDataInBackground")," method as shown in below code. First of all, you need to create an ArrayList that takes the data you want to pass in AttachedData class."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'var attachedData = [ACAttachedData]()\nattachedData.append(ACAttachedData.init(nsString: "dataName1", with: "dataValue1"))\nattachedData.append(ACAttachedData.init(nsString: "dataName2", with: "dataValue2"))\nattachedData.append(ACAttachedData.init(nsString: "dataName3", with: "dataValue3"))\nattachedData.append(ACAttachedData.init(nsString: "dataName4", with: "dataValue4"))\n')),Object(r.b)("p",null,"Then you need to pass this data in the attachedDataList parameter of the startVideoCallWithAttachedDataInBackground method."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre"},'@objc open func startVideoCallWithAttachedDataInBackground(\n                                            idNumber : Int64,\n                                            customerId : String, \n                                            customerName : String = "", \n                                            phoneNumber : Int64 = 0, \n                                            txCode: String = "",  \n                                            attachedData: [ACAttachedData], \n                                            result: @escaping (Bool, ACVideoCallError?) -> Void)\n')),Object(r.b)("p",null,"If you get success as a ",Object(r.b)("strong",{parentName:"p"},"result")," from the ",Object(r.b)("strong",{parentName:"p"},"startVideoCallWithAttachedDataInBackground")," method, you need to subscribe to the event mechanism where you can follow the status of the call."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"@objc open func subscribeToCallStateWithTxCodeEvent(listener: @escaping (_ state: String, _ txCode: String) -> Void)\n")),Object(r.b)("p",null,"CallStates that can receive from DiyalogSDK after subscribe as follows:"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"}," ",Object(r.b)("strong",{parentName:"p"},'"RINGING"'),"                : Phone is calling",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"CONNECTING"'),"              : Call accepted by both peers and Webrtc session is creating.",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"IN_PROGRESS"'),"             : Call in progress",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"ENDED"'),"                   : Call ended.",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"NO_CALL"'),"                 : Initial state. No call active.  ")),Object(r.b)("p",null,"After call completed and your logic finished for video help, you should unsubscribe from CallState event bu using following method.a\u015fa\u011f\u0131daki metod ile unsubscribe olabilirsiniz."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"@objc open func unsubscribeToCallStateWithTxCodeEvent()\n")),Object(r.b)("p",null,"You can see complete code sample that you need to implement below. You should show wait screen after getting ",Object(r.b)("strong",{parentName:"p"},"true")," from ",Object(r.b)("strong",{parentName:"p"},"result")," callback. If you receive ",Object(r.b)("strong",{parentName:"p"},"false"),", there is an error in the system and you should show error screen to customer."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'var attachedData = [ACAttachedData]()\nattachedData.append(ACAttachedData.init(nsString: "dataName1", with: "dataValue1"))\nattachedData.append(ACAttachedData.init(nsString: "dataName2", with: "dataValue2"))\nattachedData.append(ACAttachedData.init(nsString: "dataName3", with: "dataValue3"))\nattachedData.append(ACAttachedData.init(nsString: "dataName4", with: "dataValue4"))\n\nDiyalogEngine.diyalogInstance().startVideoCallWithAttachedDataInBackground(\n    idNumber: Int64("<CUSTOMER_NATIONAL_ID_NUMBER") ?? 0, \n    customerId: "<CUSTOMER_NO>", \n    customerName: "<CUSTOMER_NAME>", \n    txCode : "<YOUR_TX_CODE>", \n    attachedData: attachedData, result: {(success, errorMessage) in\n        if(success)\n        {\n            // SHOW YOUR WAIT RECRESENTATIVE SCREEN\n            DiyalogEngine.diyalogInstance().subscribeToCallStateWithTxCodeEvent(listener: {(value : String?, txCode: String?) -> Void in\n                if value != nil {\n                    print("CALL STATE CHANGED TO " + value! + " FOR TxCode : " + txCode!)\n                    if (value! == ("ENDED")){\n                        // CALL FINISHED\n                    }\n                    else if (value! == "RINGING" || value! == "CONNECTING" || value! == "IN_PROGRESS"){\n                        // CALL IN PROGRESS\n                    }\n                }\n            })\n            \n        }else{\n            print("there is an error. ErrCode : \\(String(describing: errorMessage?.getCode())). Error Msg: \\(String(describing: errorMessage?.getMsg()))")\n        }\n})\n')),Object(r.b)("p",null,"If ",Object(r.b)("strong",{parentName:"p"},"startVideoCallWithAttachedDataInBackground")," method return successfull and you showed wait screen to customer and the customer press cancel button in your wait screen before agent start video call, you should call ",Object(r.b)("strong",{parentName:"p"},"stopVideoCall")," method to stop process"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"@objc open func stopVideoCallForNewCustomer(customerId : String) -> Bool\n")),Object(r.b)("p",null,"Sample code  "),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'let result = DiyalogEngine.diyalogInstance().stopVideoCall(customerId: "<CUSTOMER_NO>")\n')),Object(r.b)("p",null,"After all process completed you can unsubscribe from the CallState event by calling "),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"@objc open func unsubscribeToCallStateWithTxCodeEvent()\n")),Object(r.b)("p",null,"Sample code  "),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"DiyalogEngine.diyalogInstance().unsubscribeToCallStateWithTxCodeEvent()\n")),Object(r.b)("p",null,"Done :)  "),Object(r.b)("h3",{id:"picture-in-picture-mode"},"Picture In Picture Mode"),Object(r.b)("p",null,"Diyalog SDK has feature picture in picture mode when video or voice call in progress.\nIt is managed by other peer. It means, Diyalog App  which is used by staff (agent) can send a manage call event to the mobile app in background and call view in mobile app automatically minimized over host application as picture in picture mode. "),Object(r.b)("p",null,"When mobile app call view is mininizing, Diyalog app that used by staff can send data (command) to mobile app in background. In this way, mobile host application can start any flow by checking the data/command for the customer during video/voice call."),Object(r.b)("p",null,"The ",Object(r.b)("strong",{parentName:"p"},"subscribeToManageCallEvent")," method is used to listen to these events. Each time a new event occurs, the callback function given to this method is called. Possible values are as follows :"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"}," ",Object(r.b)("strong",{parentName:"p"},'"NO_EVENT"'),"               : Default and initial value of the event. This event should be ignored.",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"CALL_MINIMIZED"'),"          : When this event comes, it means that the video call is minimized and the desired flow can be started. There can be additional data/command in the event.",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"MESSAGE_RECEIVED"'),"        : When this event comes, it means that data has been transmitted from the other application to the mobile application.",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"START_OPERATION"'),"        : When this event comes, it just means that the display is stopped while the voice call is in progress in the mobile client side and the main application on the mobile device can start any action flow. This event should be used in the mobile application if there will be a process where the camera will be used other than the video call. Because the operating systems of the devices do not allow camera access from different threads at the same time.")),Object(r.b)("p",null,"After subscription, ",Object(r.b)("strong",{parentName:"p"},'"CALL_MINIMIZED"')," event should be waited and ",Object(r.b)("strong",{parentName:"p"},"getManageCallEventData")," method should be used to read event data/command when this event comes up. You can redirect to the flow you want with the eventData you designed."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'DiyalogEngine.diyalogInstance().subscribeToManageCallEvent(listener: {(manageCallEvent : String?) -> Void in\n    if (manageCallEvent != nil && manageCallEvent == "CALL_MINIMIZED") {\n        let events = DiyalogEngine.diyalogInstance().getManageCallEventData()\n        for (key, value) in events {\n            if (key == "command" && value == "getCardPassword"){\n                // Do something\n            }\n        }\n    }\n})\n')),Object(r.b)("p",null,"When the call is ended or you don't want to listen to this event, you should unsubscribe your listener by calling ",Object(r.b)("strong",{parentName:"p"},"unsubscribeToManageCallEvent")," method."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"DiyalogEngine.diyalogInstance().unsubscribeToManageCallEvent()\n")),Object(r.b)("h3",{id:"start-another-operation-when-call-in-progress"},"Start Another Operation When Call In Progress"),Object(r.b)("p",null,"While the video or audio call is in progress, your representative or employee can initiate the desired transaction on the phone of the customer. There may be a camera or hardware function in the process that can be started on customer's mobile device. For example, you can start an OCR process using the camera or facial recognition when call in progres. In this mode, customer camera will be stopped only voice call continue and other process can access the camera. This is the main point that separates this process from Picture In Picture mode. "),Object(r.b)("p",null,"An operation that uses a camera on the customer's phone can be performed with 3 different methods. You can design your implementaton that supports all or some of them. These methods are as follows:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"The client view is stopped and an event is sent to the main application to perform the desired operation.\nIn this method, the customer and the representative only hear each other's voice during the operation."),Object(r.b)("li",{parentName:"ol"},"The call is minimized as picture in picture. During the operation, the customer sees and hears the voice and image of the representative in picInpic mode. The agent hears only the voice of the customer."),Object(r.b)("li",{parentName:"ol"},"Customer phone screen shared with representative by screen casting method and representative can see customer phone's screen and direct customer with voice in real time. This screencast can only done by getting permission from the customer. Permission is getting by operating system automatically.  ")),Object(r.b)("p",null,"There will be no change for the mobile application in all 3 methods. As in Picture In picture mode,  you should listen ",Object(r.b)("strong",{parentName:"p"},"ManageCallEvent")," and when you receive ",Object(r.b)("strong",{parentName:"p"},"START_OPERATION")," event, you can start any operation which describes in the details of the event. You can only focus on implementation of the operation, Diyalog SDK will manage camera stopping  or screen castion or picInPic mode."),Object(r.b)("p",null,"In other words, as in picture in picture mode, you can listen to manageCall events with the ",Object(r.b)("strong",{parentName:"p"},"subscribeToManageCallEvent")," method and start any operation according to the type of operation you want with a control like below."),Object(r.b)("p",null,"Below is sample code."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'DiyalogEngine.diyalogInstance().subscribeToManageCallEvent(listener: {(manageCallEvent : String?) -> Void in\n    if (manageCallEvent != nil && (manageCallEvent == "START_OPERATION") ) {\n        let events = DiyalogEngine.diyalogInstance().getManageCallEventData()\n        for (key, value) in events {\n            if (key == "operationName" && value == "START_NFC"){\n                print("NFC OPERATION WILL BE STARTED.")\n                // Do NFC operation. UdentifyNFC is used to show how it is working in this sample code. You can use different libs\n                let storyBoardNFC = UIStoryboard(name: "Udentify", bundle: nil)\n                let nfc = storyBoardNFC.instantiateViewController(withIdentifier: "udentifyViewController") as!UdentifyViewController\n                self.present(nfc, animated: true, completion: nil)\n            }\n            else if (key == "operationName" && value == "START_OCR"){\n                print("MANAGECALLEVENT OCR OPERATION WILL BE STARTED.")\n                // Do OCR operation\n            }\n            else if (key == "operationName" && value == "START_FACE_RECOGNITION"){\n                print("MANAGECALLEVENT FACE RECOGNITION OPERATION WILL BE STARTED.")\n                // Do Face Recognition operation\n            }\n            else if (key == "operationName" && value == "<OPERATION_YOU_DEFINED>"){\n                print("MANAGECALLEVENT ANOTHER OPERATION WILL BE STARTED.")\n                // Do what you need\n            }\n\n        }\n    }\n\n})\n')),Object(r.b)("p",null,"After your operation completed, you should call below method of the Diyalog SDK in order to turn back to video call. Of course, before calling this method, if the main application is performing an operation on the device's camera, the camera access must be closed and then the method must be called. Otherwise, the application may crash."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"DiyalogEngine.diyalogInstance().turnBackToVideoCall()\n")),Object(r.b)("p",null,"Representative may also order turn back to call by remotely. SDK will notify the main application with ",Object(r.b)("strong",{parentName:"p"},"diyalog.camerastartedincall")," string object. Again, the main application should dismiss views of the operation and close the camera access when this notification received. Therefore this notification should listen via NotificationCenter."),Object(r.b)("p",null,"You can see how you can listen and act to it in below sample code."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'NotificationCenter.default.addObserver(self,\n                                      selector: #selector(cameraStartedInCall),\n                                      name: NSNotification.Name ("diyalog.camerastartedincall"), \n                                      object: nil)\n\n@objc func cameraStartedInCall(_ notification: Notification){\n  // stop camera access and dismiss your view.\n}      \n')),Object(r.b)("h3",{id:"receiving-data-from-remote-party-in-a-call"},"Receiving Data From Remote Party In a Call"),Object(r.b)("p",null,"Mobile app can receive any message or data from other party (agent or staff) during video/voice call in background. Staff or agent application can send any data/command/message to the mobile app during call in progress by means of DiyalogSDK."),Object(r.b)("p",null,"This messages can be get by subscribing to manage call events. "),Object(r.b)("p",null,"The ",Object(r.b)("strong",{parentName:"p"},"subscribeToManageCallEvent")," method is used to listen to these events. Each time a new event occurs, the callback function given to this method is called. Possible values are as follows :"),Object(r.b)("blockquote",null,Object(r.b)("p",{parentName:"blockquote"}," ",Object(r.b)("strong",{parentName:"p"},'"NO_EVENT"'),"               : Default and initial value of the event. This event should be ignored.",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"CALL_MINIMIZED"'),"          : When this event comes, it means that the video call is minimized and the desired flow can be started. There can be additional data/command in the event.",Object(r.b)("br",{parentName:"p"}),"\n","",Object(r.b)("strong",{parentName:"p"},'"MESSAGE_RECEIVED"'),"        : When this event comes, it means that data has been transmitted from the other application to the mobile application.  ")),Object(r.b)("p",null,"After subscription, ",Object(r.b)("strong",{parentName:"p"},'"MESSAGE_RECEIVED"')," event should be waited and ",Object(r.b)("strong",{parentName:"p"},"getManageCallEventData")," method should be used to read event data/command when this event comes up. You can redirect to the flow you want with the eventData you designed."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'DiyalogEngine.diyalogInstance().subscribeToManageCallEvent(listener: {(manageCallEvent : String?) -> Void in\n    print("MANAGECALLEVENT received. event : \\(manageCallEvent)")\n    if (manageCallEvent != nil && (manageCallEvent == "MESSAGE_RECEIVED") ) {\n        let events = DiyalogEngine.diyalogInstance().getManageCallEventData()\n        for (key, value) in events {\n            print("MANAGECALLEVENT key : \\(key) value : \\(value)")\n            if (key == "command" && value == "getCardPassword"){\n                // Do something\n            }\n        }\n    }\n})\n')),Object(r.b)("h3",{id:"sending-data-to-remote-party-in-a-call"},"Sending Data To Remote Party In a Call"),Object(r.b)("p",null,"You can send any data from mobile app to remote staff or agent app by means of DiyalogSDK during call."),Object(r.b)("p",null,"For doing this, you can call below method with eventData array."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},"@objc open func sendMessageToRemote(eventData : [ACEventData], result: @escaping (Bool, String) -> Void)\n")),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"ACEventData")," stores keyName and keyValue strings. This data is transfered to remote by calling sendMessageToRemote method."),Object(r.b)("p",null,"Sample usage :"),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-jsx"},'var eventData = [ACEventData]()\neventData.append(ACEventData.init(nsString: "processName", with: "CustOnboarding"))\neventData.append(ACEventData.init(nsString: "processState", with: "customer_approve_by_pin"))\n\nDiyalogEngine.diyalogInstance().sendMessageToRemote(\n                      eventData: eventData, \n                      result: {(success, resMessage) in\n        print("sendMessageToRemote finished. isSuccess: \\(success), resMessage: \\(resMessage)")\n})\n')),Object(r.b)("p",null,"In this sample code remote peer (agent / staff app) will receive following json object. Sending a message to the remote peer is only possible during call."),Object(r.b)("pre",null,Object(r.b)("code",{parentName:"pre",className:"language-json"},"{\n      eventType: 'sendMessage',   \n      manageCallEventData: [  \n          {dataName: 'processName', dataValue: 'CustOnboarding'},  \n          {dataName: 'processState', dataValue: 'customer_approve_by_pin'}  \n      ]  \n}  \n")),Object(r.b)("h3",{id:"sample-ios-project"},"Sample IOS project"),Object(r.b)("p",null,"You can download full simple video call ios project from ",Object(r.b)("a",{parentName:"p",href:"https://web.diyalog.im/app/pkgs/demoapps/SimpleVideoCall_IOS.zip"},"SimpleVideoCall_IOS")," link."))}f.isMDXComponent=!0},158:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return m}));var n=a(0),o=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=o.a.createContext({}),d=function(e){var t=o.a.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},b=function(e){var t=d(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},u=o.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),b=d(a),u=n,m=b["".concat(i,".").concat(u)]||b[u]||p[u]||r;return a?o.a.createElement(m,l(l({ref:t},s),{},{components:a})):o.a.createElement(m,l({ref:t},s))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var s=2;s<r;s++)i[s]=a[s];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"},159:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i}));var n=a(16),o=a(160);function r(){const{siteConfig:{baseUrl:e="/",url:t}={}}=Object(n.default)();return{withBaseUrl:(a,n)=>function(e,t,a,{forcePrependBaseUrl:n=!1,absolute:r=!1}={}){if(!a)return a;if(a.startsWith("#"))return a;if(Object(o.b)(a))return a;if(n)return t+a;const i=a.startsWith(t)?a:t+a.replace(/^\//,"");return r?e+i:i}(t,e,a,n)}}function i(e,t={}){const{withBaseUrl:a}=r();return a(e,t)}},160:function(e,t,a){"use strict";function n(e){return!0===/^(\w*:|\/\/)/.test(e)}function o(e){return void 0!==e&&!n(e)}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return o}))},219:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/video_help_flow-af3b0e18b96ca5a82070239e2114674e.png"}}]);