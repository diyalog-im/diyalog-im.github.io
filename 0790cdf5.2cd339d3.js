(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{132:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return b})),a.d(t,"Highlight",(function(){return s})),a.d(t,"HighlightWithBlack",(function(){return c})),a.d(t,"ColoredText",(function(){return p})),a.d(t,"CenteredText",(function(){return d})),a.d(t,"GreenColoredText",(function(){return u})),a.d(t,"BlueColoredText",(function(){return O})),a.d(t,"rightToc",(function(){return h})),a.d(t,"default",(function(){return m}));var n=a(1),r=a(9),o=(a(197),a(196)),l=a(199),i={id:"diyalog-messaging-api-sendotp-api",title:"SendOTP API",sidebar_label:"SendOTP API"},b={id:"diyalog-messaging-api-sendotp-api",title:"SendOTP API",description:"export const Highlight = ({children, color}) => (",source:"@site/../docs/diyalog-messaging-api-sendotp-api.md",permalink:"/docs/diyalog-messaging-api-sendotp-api",sidebar_label:"SendOTP API",sidebar:"docs",previous:{title:"Button Template Message",permalink:"/docs/diyalog-messaging-api-buttontemplate"},next:{title:"Webhook",permalink:"/docs/webhook"}},s=function(e){var t=e.children,a=e.color;return Object(o.b)("span",{style:{backgroundColor:a,borderRadius:"2px",color:"#fff",padding:"0.2rem"}},t)},c=function(e){var t=e.children,a=e.color;return Object(o.b)("span",{style:{backgroundColor:a,borderRadius:"2px",padding:"0.2rem"}},t)},p=function(e){var t=e.children,a=e.color;return Object(o.b)("span",{style:{color:a}},t)},d=function(e){var t=e.children;return Object(o.b)("span",{style:{align:"center"}},t)},u=function(e){var t=e.children;return Object(o.b)("span",{style:{color:"#42b72a"}},t)},O=function(e){var t=e.children;return Object(o.b)("span",{style:{color:"#1877F2"}},t)},h=[{value:"Request URI",id:"request-uri",children:[]},{value:"Request Details",id:"request-details",children:[{value:"<GreenColoredText>buttonV2</GreenColoredText>",id:"greencoloredtextbuttonv2greencoloredtext",children:[]}]},{value:"Response",id:"response",children:[]}],g={Highlight:s,HighlightWithBlack:c,ColoredText:p,CenteredText:d,GreenColoredText:u,BlueColoredText:O,rightToc:h};function m(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},g,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("p",null,"If you want to send a one-time password (mobile confirmation code) to your users, you can use this api.\nUnder normal circumstances, you can send OTP to your users using the SendMessage api, but if you use this api,\notp messages that you send are logged in a separate databases and they can be analused when requested by admin users."),Object(o.b)("p",null,"Another advantage of sending otp messages with this api instead of SendMessage api is in the processing of the otp message\nin the mobile clients. DLG Mobile SDK will process the otp message and fire otp value to main application that use itself.\nBy this way, main application can use otp value automatically without need of any intervention by user."),Object(o.b)("p",null,"OTP messages can consist of text, images and buttons.\nIf you want you can send otp message that has only text, or text and image or text, buttons or text, image and buttons"),Object(o.b)("img",{alt:"",src:Object(l.a)("img/otpmessage.png"),height:"300px"}),Object(o.b)("h2",{id:"request-uri"},"Request URI"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-js"}),"https://<DIYALOG-SERVER-API-ENDPOINT>/v1/bots/sendmok/<YOUR-BOT-ACCESS-TOKEN>\n")),Object(o.b)("h4",{id:"example-request"},"Example Request"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-powershell"}),'curl -X POST -H "Content-Type: application/json" -d \'{\n    "customerNo": "123456789",\n    "messageId": "messageId-74",\n    "mokMessage": "Your one time password is \\"123456\\" ",\n    "mokValue": "33",\n    "imageUrl" : "https://dlgmessenger.com/otp.jpg",\n    "txCode": "LOG2",\n    "deviceId": "628FAF5A-B690-4E1A-A0EC-1518A6334F0B",\n    "buttonsV2" : \n     [\n             {\n                "type" :"postback",\n                "title" : "Approve",\n                "payload" : "123456",\n                "payloadHidden" : true,\n                "payloadSeenByUser": "Onayl\u0131yorum"\n            },\n             {\n                "type" :"postback",\n                "title" : "Dismiss",\n                "payload" : "cancelled",\n                "payloadSeenByUser": "\u0130ptal Edildi"\n            }\n        ]\n}\' "https://<DIYALOG-SERVER-API-ENDPOINT>/v1/bots/sendmok/<YOUR-BOT-ACCESS-TOKEN>"\n')),Object(o.b)("h2",{id:"request-details"},"Request Details"),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Property"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Type"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Description"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Mandatory"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"customerNo"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"It is the customer id that you want to send otp message."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Yes")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"messageId"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"It is message id that received from the request of your message. When a button pressed in the Button Template message by user, this id will return to your application with the payload of the button. By this way, you will have an additional data that will help you find which button pressed."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Yes")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"mokMessage"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"It is the otp message text."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Yes")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"mokValue"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"It is the value of the otp. This property will be used to fire otp value as event to the main mobile application that use DLG mobile SDK."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Optional")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"imageUrl"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"If you want to add an image to your otp message, you can give the uri address of your image to this field."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Optional")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"txCode"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"This property is helpfull for logging the otp messages according to transaction code that otp send for. This property is only used for analysis."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Optional")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"deviceId"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"This property is helpfull for logging the otp messages according to users's mobile device id that otp send for. This property is only used for analysis."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Optional")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"buttonsV2"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Array<",Object(o.b)("a",Object(n.a)({parentName:"td"},{href:"#greencoloredtextbuttonv2greencoloredtext"}),"buttonV2"),">"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"You can add buttons like confirm or cancel to your OTP message by this property. With these buttons, the user can automatically receive confirmation to your otp messages."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Optional")))),Object(o.b)("h3",{id:"greencoloredtextbuttonv2greencoloredtext"},Object(o.b)(u,{mdxType:"GreenColoredText"},"buttonV2")),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Property"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Type"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Description"),Object(o.b)("th",Object(n.a)({parentName:"tr"},{align:null}),"Mandatory"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"type"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),'Determines the behavior of the button when the button is pressed. There are two types, "postback" and "web_url".'),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Yes")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"title"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Title of the button."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Yes")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"payload"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"It is the payload of the button. If button type is ",Object(o.b)("strong",{parentName:"td"},'"postback"'),",  the value of this property will return to your application via webhook when pressed the button by the user. If button type is ",Object(o.b)("strong",{parentName:"td"},'"web_url"'),", the value of it should be a valid uri address. Because when pressed the button, this uri will be open in the user's device."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Yes")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"payloadHidden"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Boolean"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"This property is applicable for postback type of button. If it is set as true, the payload of the button signed with your company's secret keys in the user's device, return to your application via webhook when user pressed the button."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Optional")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"payloadSeenByUser"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"String"),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"The value of this property will be displayed in the chat screen of the user when pressed the button. If it does not set, the value of the payload will be displayed in the chat screen."),Object(o.b)("td",Object(n.a)({parentName:"tr"},{align:null}),"Optional")))),Object(o.b)(s,{color:"#da3d5f",mdxType:"Highlight"},"Important Note :"),Object(o.b)("p",null,"When user pressed a button in a message,  the value of the payload property will return to your application via webhook mechanism."),Object(o.b)("p",null,"If the value of the ",Object(o.b)("strong",{parentName:"p"},"payloadHidden")," is ",Object(o.b)("strong",{parentName:"p"},"true"),",\nthe payload of the button signed with your company's secret keys in the user's device,\nreturn to your application via webhook when user pressed the button.\nBy this way, you can be sure about the payload return from a valid device.\nSure, your application can decrypt and validate the signed payload."),Object(o.b)("p",null,"Another critical information is ",Object(o.b)(u,{mdxType:"GreenColoredText"},"messageId")," in the ",Object(o.b)("a",Object(n.a)({parentName:"p"},{href:"(#greencoloredtextpayloadgreencoloredtext)%3E"}),"payload"),"  object. It is important, because it is returned to your application together with payload when user pressed the button. By this way, you can determine which button pressed in which messsage."),Object(o.b)("p",null,"Message id will return with payload of the button to your application in the following format.",Object(o.b)("br",{parentName:"p"}),"\n",'"',"[","<","messageId",">","]:","<","payload",">",'" ( when payloadHidden is false)',Object(o.b)("br",{parentName:"p"}),"\n",'"',"[","<","messageId",">","]:","<","signed payload",">",'" ( when payloadHidden is true) '),Object(o.b)("h2",{id:"response"},"Response"),Object(o.b)("p",null,"Successful API requests return the json object with the answer code  ",Object(o.b)("strong",{parentName:"p"},"http-2XX"),".  "),Object(o.b)("p",null,"Sample response"),Object(o.b)("pre",null,Object(o.b)("code",Object(n.a)({parentName:"pre"},{className:"language-json"}),'{\n   "recipient_id": "2074022437",\n   "message_id": "-7523925115459309081"\n}\n')))}m.isMDXComponent=!0},198:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(50);t.default=function(){return Object(n.useContext)(r.a)}},199:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a(200);var n=a(198);function r(e){var t=(Object(n.default)().siteConfig||{}).baseUrl,a=void 0===t?"/":t;if(!e)return e;return/^(https?:|\/\/)/.test(e)?e:e.startsWith("/")?a+e.slice(1):a+e}},200:function(e,t,a){"use strict";var n=a(17),r=a(36),o=a(201),l="".startsWith;n(n.P+n.F*a(202)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),a=r(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return l?l.call(t,n,a):t.slice(a,a+n.length)===n}})},201:function(e,t,a){var n=a(69),r=a(23);e.exports=function(e,t,a){if(n(t))throw TypeError("String#"+a+" doesn't accept regex!");return String(r(e))}},202:function(e,t,a){var n=a(2)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(a){try{return t[n]=!1,!"/./"[e](t)}catch(r){}}return!0}}}]);